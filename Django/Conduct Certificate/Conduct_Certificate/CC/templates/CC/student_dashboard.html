{% extends 'CC/base.html' %}
{% block content %}
<br/>
<h2 class="text-center">My Certificate Requests</h2>

<!-- Button to create a new request -->
<a href="{% url 'conduct_request' %}" class="btn btn-info mb-3" style="margin-left: 86%;">New Request</a>

<!-- ================= Conduct Certificates ================= -->
<h4>Conduct Certificates</h4>
<table class="table table-bordered table-striped" style="width: 90%; margin: auto;">
    <thead>
        <tr>
            <th>Academic Year</th>
            <th>Degree</th>
            <th>Branch</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for cert in conduct_requests %}
        <tr>
            <td>{{ cert.academic_year_from }} - {{ cert.academic_year_to }}</td>
            <td>{{ cert.degree }}</td>
            <td>{{ cert.branch }}</td>
            <td>
                {% if cert.status == "Pending" %}
                    <span class="badge bg-warning text-dark">Pending</span>
                {% elif cert.status == "Approved" %}
                    <span class="badge bg-success">Approved</span>
                {% else %}
                    <span class="badge bg-danger">Rejected</span>
                {% endif %}
            </td>
            <td>
                <a href="{% url 'certificate_preview' 'conduct' cert.id %}" class="btn btn-primary btn-sm">Preview</a>
                {% if cert.status == "Pending" %}
                    <a href="{% url 'certificate_edit' 'conduct' cert.id %}" class="btn btn-warning btn-sm">Edit</a>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="5" class="text-center">No requests found</td></tr>
        {% endfor %}
    </tbody>
</table>

<!-- ================= Transfer Certificates ================= -->
<h4 class="mt-4">Transfer Certificates</h4>
<table class="table table-bordered table-striped" style="width: 90%; margin: auto;">
    <thead>
        <tr>
            <th>Student Name</th>
            <th>DOB</th>
            <th>Admission No</th>
            <th>Course</th>
            <th>Date of Leaving</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for cert in transfer_requests %}
        <tr>
            <td>{{ cert.student_name }}</td>
            <td>{{ cert.dob }}</td>
            <td>{{ cert.admission_no }}</td>
            <td>{{ cert.course }}</td>
            <td>{{ cert.date_of_leaving }}</td>
            <td>
                {% if cert.status == "Pending" %}
                    <span class="badge bg-warning text-dark">Pending</span>
                {% elif cert.status == "Approved" %}
                    <span class="badge bg-success">Approved</span>
                {% else %}
                    <span class="badge bg-danger">Rejected</span>
                {% endif %}
            </td>
            <td>
                <a href="{% url 'certificate_preview' 'transfer' cert.id %}" class="btn btn-primary btn-sm">Preview</a>
                {% if cert.status == "Pending" %}
                    <a href="{% url 'certificate_edit' 'transfer' cert.id %}" class="btn btn-warning btn-sm">Edit</a>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="7" class="text-center">No requests found</td></tr>
        {% endfor %}
    </tbody>
</table>

<!-- ================= Employee Joining Policies ================= -->
<h4 class="mt-4">Employee Joining Policies</h4>
<table class="table table-bordered table-striped" style="width: 90%; margin: auto;">
    <thead>
        <tr>
            <th>Employee Name</th>
            <th>Designation</th>
            <th>Joining Date</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for cert in employee_requests %}
        <tr>
            <td>{{ cert.employee_name }}</td>
            <td>{{ cert.designation }}</td>
            <td>{{ cert.joining_date }}</td>
            <td>
                {% if cert.status == "Pending" %}
                    <span class="badge bg-warning text-dark">Pending</span>
                {% elif cert.status == "Approved" %}
                    <span class="badge bg-success">Approved</span>
                {% else %}
                    <span class="badge bg-danger">Rejected</span>
                {% endif %}
            </td>
            <td>
                <a href="{% url 'certificate_preview' 'employee' cert.id %}" class="btn btn-primary btn-sm">Preview</a>
                {% if cert.status == "Pending" %}
                    <a href="{% url 'certificate_edit' 'employee' cert.id %}" class="btn btn-warning btn-sm">Edit</a>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="5" class="text-center">No requests found</td></tr>
        {% endfor %}
    </tbody>
</table>

<!-- ================= Rental Agreements ================= -->
<h4 class="mt-4">Rental Agreements</h4>
<table class="table table-bordered table-striped" style="width: 90%; margin: auto;">
    <thead>
        <tr>
            <th>Tenant Name</th>
            <th>Landlord Name</th>
            <th>Property Address</th>
            <th>Rent Amount</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for cert in rental_requests %}
        <tr>
            <td>{{ cert.tenant_name }}</td>
            <td>{{ cert.landlord_name }}</td>
            <td>{{ cert.property_address }}</td>
            <td>{{ cert.rent_amount }}</td>
            <td>{{ cert.start_date }}</td>
            <td>{{ cert.end_date }}</td>
            <td>
                {% if cert.status == "Pending" %}
                    <span class="badge bg-warning text-dark">Pending</span>
                {% elif cert.status == "Approved" %}
                    <span class="badge bg-success">Approved</span>
                {% else %}
                    <span class="badge bg-danger">Rejected</span>
                {% endif %}
            </td>
            <td>
                <a href="{% url 'certificate_preview' 'rental' cert.id %}" class="btn btn-primary btn-sm">Preview</a>
                {% if cert.status == "Pending" %}
                    <a href="{% url 'certificate_edit' 'rental' cert.id %}" class="btn btn-warning btn-sm">Edit</a>
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="8" class="text-center">No requests found</td></tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
