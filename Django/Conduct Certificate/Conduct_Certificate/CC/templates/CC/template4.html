{% extends 'CC/base.html' %}
{% block content %}
<br/>
<div id="certificate" style="width: 800px; margin: auto; padding: 50px; border: 6px solid #4b5563; font-family: 'Verdana', sans-serif; background: linear-gradient(#ffffff, #f3f4f6); box-shadow: 0 0 15px rgba(0,0,0,0.15);">

    <h1 style="text-align: center; font-size: 2.5rem; font-weight: bold; color: #374151; letter-spacing: 1px; margin-bottom: 10px;">
        Conduct Certificate
    </h1>
    <hr style="border: 1px solid #4b5563; width: 65%; margin: auto; margin-bottom: 25px;">

    <p style="margin-top: 25px; font-size: 1.2rem; line-height: 1.9; text-align: justify;">
        This is to certify that <strong style="color: #1f2937; text-decoration: underline;">{{ cert.name }}</strong> successfully studied 
        <strong>{{ cert.degree }}</strong> in <strong>{{ cert.branch }}</strong> from 
        <strong>{{ cert.academic_year_from }}</strong> to <strong>{{ cert.academic_year_to }}</strong>.  
        The student is found to be disciplined and of good character.
    </p>

    <div style="margin-top: 75px; display: flex; justify-content: space-between; font-size: 1rem;">
        <div>
            <p>Date: <strong>{{ cert.approved_date|date:"d M Y" }}</strong></p>
            <p>Signature:</p>
            <img src="{{ cert.signature.url }}" width="120" style="margin-top: 10px;">
        </div>
        <div style="text-align: right;">
            <p>Principalâ€™s Signature:</p>
            {% if cert.principal_signature %}
                <img src="{{ cert.principal_signature.url }}" width="120" style="margin-top: 10px;">
            {% else %}
                <p style="color: gray; font-style: italic;">(Not signed yet)</p>
            {% endif %}
        </div>
    </div>
</div>

<div style="text-align: center; margin-top: 20px;">
    <button id="downloadBtn" class="btn btn-secondary">Download PDF</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>
document.getElementById('downloadBtn').addEventListener('click', function () {
    const element = document.getElementById('certificate');
    html2pdf().set({
        margin: 0.5,
        filename: 'conduct_certificate.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 3 },
        jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
    }).from(element).save();
});
</script>
{% endblock %}
